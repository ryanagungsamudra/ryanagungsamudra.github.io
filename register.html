<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap v5.2 -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
    
    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700;900&family=Rubik:wght@400;500;700&display=swap"
        rel="stylesheet">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/register.css">
    
    <title>Register</title>
    <link rel="icon" type="image/x-icon" href="img/coffeeLogo.svg">
</head>
<body>

    <main>
        <div class="bg-primary text-white hero">
            <!-- content start -->
            <div class="container container-1">
                <div class="row">
                    <div class="col text-end">
                        <img id="reset" src="img/register/reset.png" alt="reset" style="width: 40px; height: 30px; margin-top: 1.3rem; margin-right: 0.5rem;">
                    </div>
                </div>
                <div class="row text-center text-dark" style="margin-top: -0.2rem;">
                    <div class="col">
                        <h2>Hello there!</h2>
                        <h5 id="email-title"></h5>
                    </div>
                </div>
                <div class="row text-center text-danger pt-3">
                    <div class="col">
                        <h5>Please complete your personal information below</h5>
                    </div>
                </div>

                <div class="row pt-3">
                    <!-- FORM START -->
                    <div class="col-2"></div>
                    <div class="col text-dark">
                        <form name="registerForm" class="row g-3">
                            <div class="col-md-6">
                                <label for="inputFirstName" class="form-label">First name</label>
                                <input type="text" class="form-control" id="firstName" placeholder="input your first name here" name="firstName">
                            </div>
                            <div class="col-md-6">
                                <label for="inputLastName" class="form-label">Last name</label>
                                <input type="text" class="form-control" id="lastName" placeholder="input your last name here" name="lastName">
                            </div>
                            <div class="col-12 pt-2">
                                <label for="inputAddress" class="form-label">Address</label>
                                <input type="text" class="form-control" id="address" placeholder="input your address here" name="address">
                            </div>
                            <div class="col-12 pt-2">
                                <label for="inputPhoneNumber" class="form-label">Phone Number
                                    :</label>
                                <input type="number" class="form-control" id="mobileNumber" placeholder="Enter your phone number" name="mobileNumber">
                            </div>
                            <div class="col-12 pt-2">
                                <label for="inputDate" class="form-label">DD/MM/YY</label>
                                <input type="text" class="form-control" id="birthDate" placeholder="28/07/99" name="birthDate">
                            </div>
                            <div class="col-12 pt-2">
                                <label for="gender" class="pe-2">Gender :</label>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="gender" id="male" value="male">
                                    <label class="form-check-label" for="male">Male</label>
                                </div>
                                <div class="form-check form-check-inline">
                                    <input class="form-check-input" type="radio" name="gender" id="female" value="female">
                                    <label class="form-check-label" for="female">Female</label>
                                </div>
                            </div>
                            <div class="col-12 pt-2">
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="gridCheck">
                                    <label class="form-check-label" for="gridCheck">
                                        Agree to terms and conditions
                                    </label>
                                </div>
                            </div>
                            <div class="col-12 pt-1 text-center">
                                <button type="submit" id="submit-btn" class="btn btn-success rounded-3"><span class="px-4">Submit</span></button>
                            </div>
                        </form>
                    </div>
                    <div class="col-2"></div>
                    <!-- FORM END -->
                </div>

                <!-- New element adding in JS -->
                <!-- <div class="row card-container" style="margin-top: 6.5rem;">
                    <div class="col-2"></div>
                    <div class="col">
                        <div class="card mb-3 text-dark rounded-4" style="width: 26.5rem;">
                            <div class="row g-0">
                                <div class="col-md-4">
                                    <img src="./img/register/man.png" class="img-fluid rounded-start m-1 ms-4 w-75" alt="ava">
                                    <p class="card-text" style="margin-top: -0.2rem; margin-left: 2.7rem;">28/07/99</p>
                                </div>
                                <div class="col-md-7">
                                    <div class="card-body ms-1">
                                        <h5 class="card-title">Ryan Agung Samudra</h5>
                                        <p class="card-text">ryansamudra67@gmail.com</p>
                                        <p class="card-text" style="margin-top: -1rem;">082284798890</p>
                                        <p class="card-text" style="margin-top: -1rem;">Elangsono St Yogyakarta</p>
                                    </div>
                                </div>
                                <div class="col-md-1">
                                    <button id="remove-btn" class="btn"><b style="color: red;">X</b></button>
                                    <div class="col-12 text-center" style="margin-top: 4.5rem; margin-left: -3rem;">
                                        <button type="submit" id="confirm-btn" onclick="passValues()" class="btn btn-success">Confirm</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-2"></div>
                </div> -->
            
            </div>
            <!-- content end -->
        </div>
    </main>
    
    <!-- Footer Start -->
    <footer>
        <div class="container-fluid" style="background-color: #F8F8F8; height: 440px;">
            <div class="container">
                <div class="row">
                    <div class="col-8 pt-footer">
                        <a href="index.html">
                            <img src="img/coffeeLogo.svg" alt="logo" class="pb-2">
                            <p class="d-inline ps-2"
                                style="text-decoration: none; color: #0B132A; font-size: 20px; font-weight: 700;">YANNN
                                COFFEE</p>
                        </a>
                        <p class="mt-3" style="font-size: 16px; font-weight: 500; color: #4F5665;">
                            Coffee Shop is a store that sells some good <br>meals, and especially coffee. We provide
                            <br>high quality beans
                        </p>
                        <div class="d-lg-flex">
                            <a href="https://www.facebook.com/ryanagungsamudra/" target="_blank"
                                style="margin-left: -20px;">
                                <img src="img/Facebook.svg" alt="Facbook">
                            </a>
                            <a href="https://mobile.twitter.com/ryansamudra67" target="_blank" style="margin-left: -15px;">
                                <img src="img/Twitter.svg" alt="Twitter">
                            </a>
                            <a href="https://instagram.com/ryanagungsamudra/" target="_blank" style="margin-left: -15px;">
                                <img src="img/Instagram.svg" alt="Instagram">
                            </a>
                        </div>
    
                        <p style="color: #AFB5C0; font-size: 16px; font-weight: 400;">Â©2022CoffeeStore</p>
                    </div>
                    <div class="col-2 pt-footer">
                        <h5 class="mb-4">Product</h5>
                        <a href="#">
                            <p>Download</p>
                        </a>
                        <a href="#">
                            <p>Pricing</p>
                        </a>
                        <a href="#">
                            <p>Locations</p>
                        </a>
                        <a href="#">
                            <p>Countries</p>
                        </a>
                        <a href="#">
                            <p>Blog</p>
                        </a>
                        <a href="userdata.html">
                            <p>User Data</p>
                        </a>
                    </div>
                    <div class="col-2 pt-footer">
                        <h5 class="mb-4">Engage</h5>
                        <a href="#">
                            <p>Coffe Shop ?</p>
                        </a>
                        <a href="#">
                            <p>FAQ</p>
                        </a>
                        <a href="#">
                            <p>About Us</p>
                        </a>
                        <a href="#">
                            <p>Privacy Policy</p>
                        </a>
                        <a href="#">
                            <p>Terms of Service</p>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!-- Footer End -->

    <script type="text/javascript" src="js/bootstrap.min.js"></script>

    <script>
        // catch data from local storage
        const user = localStorage.getItem("id")

        // FETCH API : GET & PUT
        fetch(`https://639fe7117aaf11ceb8a2b9a7.mockapi.io/yannncoffeeusers/${user}`, {
            method: 'GET',
        })
            .then(response => response.json())
            .then(data => {
                // show email and mobileNumber data to html from signup page
                document.getElementById("email-title").innerHTML = data.email
                document.getElementById("mobileNumber").value = data.mobileNumber
                let email = data.email

            // ADD AND REMOVE ELEMENT START
                // 1. Create div and add it to webpage  
                let div = document.createElement("div");
                div.classList.add("row")
                div.classList.add("card-container")

                let containerDiv = document.querySelector(".container")
                containerDiv.appendChild(div)

                // 2. add event listener on submit button
                let submitBtn = document.getElementById("submit-btn");
                submitBtn.addEventListener("click", displayDetail);

                // 3. Create displayDetail function
                function displayDetail(event) {
                    event.preventDefault()
                    
                    // collecting the form data
                    const formElement = document.querySelector("form[name=registerForm]")
                    const formData = new FormData(formElement)
                    const data = new URLSearchParams(formData)
                    let firstname = formData.get("firstName")
                    let lastName = formData.get("lastName")
                    let fullName = `${firstname} ${lastName}`
                    let address = formData.get("address")
                    let mobileNumber = formData.get("mobileNumber")
                    let birthDate = formData.get("birthDate")
                    let gender = formData.get("gender")
                    let source = gender === "male" ? "./img/register/man.png" : "./img/register/woman.png"

                    let html = `
                    <div class="row" id="display-card">
                        <div class="col-2"></div>
                        <div class="col">
                            <div class="card mb-3 text-dark rounded-4" style="width: 26.5rem;">
                                <div class="row g-0">
                                    <div class="col-md-4">
                                        <img src="${source}" class="img-fluid rounded-start m-1 ms-4 w-75" alt="ava">
                                        <p class="card-text" style="margin-top: -0.2rem; margin-left: 2.7rem;">${birthDate}</p>
                                    </div>
                                    <div class="col-md-7">
                                        <div class="card-body ms-1">
                                            <h5 class="card-title">${fullName}</h5>
                                            <p class="card-text">${email}</p>
                                            <p class="card-text" style="margin-top: -1rem;">${mobileNumber}</p>
                                            <p class="card-text" style="margin-top: -1rem;">${address}</p>
                                        </div>
                                    </div>
                                    <div class="col-md-1">
                                        <button id="remove-btn" class="btn"><b style="color: red;">X</b></button>
                                        <button type="submit" id="confirm-btn" onclick="passValues()" class="btn btn-success rounded-3" style="margin-top: 4.1rem; margin-left: -3rem;">Confirm</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-2"></div>
                    </div>`
                    // add the content to the div
                    div.insertAdjacentHTML("beforeend", html)

                    // FETCH : PUT
                    fetch(`https://639fe7117aaf11ceb8a2b9a7.mockapi.io/yannncoffeeusers/${user}`, {
                        method: 'PUT',
                        body: data
                    })
                        .then(response => response.json())
                        .then(data => {
                            console.log(data)
                            localStorage.setItem("id", data.id);

                        })
                        .catch(error => error)

                    // Deleting the element with X button
                    let btn = document.querySelector("#remove-btn")
                        btn.addEventListener("click", function () {
                            let warning = confirm("Are you sure want to delete this?")
                            let removeEl = this.parentNode.parentNode.parentNode.parentNode.parentNode
                            if (warning) {
                                div.removeChild(removeEl)
                            }
                        })

                    // confirm data and send it to profile page
                    const confirmBtn = document.getElementById("confirm-btn");
                    confirmBtn.addEventListener("click", function (event) {
                        event.preventDefault();
                        window.location.href = "profile.html"
                    })
                }
                // ADD AND REMOVE ELEMENT END
            })
            .catch(error => error)

        // FETCH API : DELETE (delete data from API if reset image clicked)
        const reset = document.getElementById("reset")
        reset.addEventListener("click", function () {
            let warning = confirm("Your data will be deleted and you will be redirected to the sign up page, are you sure?")
            if(warning){
                const formElement = document.querySelector("form[name=registerForm]")
                const formData = new FormData(formElement)
                const data = new URLSearchParams(formData)
    
                fetch(`https://639fe7117aaf11ceb8a2b9a7.mockapi.io/yannncoffeeusers/${user}`, {
                    method: 'DELETE',
                    body: data
                })
                    .then(response => response.json())
                    .then(data => {
                        console.log(data)
                        localStorage.clear();
                        window.location.href = "signup.html"
                    })
                    .catch(error => error)
            }
        })

    </script>

    
</body>
</html>